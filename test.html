<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MHN NOW 跨時區表@空軍基地</title>

    <link rel="stylesheet" href="style.css">

</head>
<body>
    <table class="rwd-pc" id="rwd-pc">
        <tr class="tr">
            <td>時區</td>
            <td>地點</td>
            <td>座標</td>
            <td colspan="2">開始時間</td>
            <td colspan="2">結束時間</td>
            <td></td>
            <td></td>
        </tr>
        
    <!--  <tr class="tr">
            <td>+14</td>
            <td>聖誕島</td>
            <td class="location">1.8222,-157.4587</td>
            <td>12/4</td>
            <td>18:00</td>
            <td>12/5</td>
            <td>17:59</td>
            <td><i class="fa-regular fa-copy"></i></td>
            <td class="checked"><i class="fa-solid fa-check"></i> 已複製</td>
        </tr> -->
     
      
    </table>

    <div class="rwd-mb">
        <div class="row tr">
            <div class="col">
                <div>+14 聖誕島</div>
                <div class="location">1.8222,-157.4587</div>
            </div>
            <div class="col">
                <div>12/4 18:00 開始</div> ~ 
                <div>12/5 17:59 結束</div>
            </div>
            <i class="fa-regular fa-copy"></i>
            <div class="checked"><i class="fa-solid fa-check"></i> 已複製</div>
        </div>
    
    </div>
  
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-Avb2QiuDEEvB4bZJYdft2mNjVShBftLdPG8FJ0V7irTLQ8Uo0qcPxh4Plq7G5tGm0rU+1SPhVotteLpBERwTkw==" crossorigin="anonymous" referrerpolicy="no-referrer" /> 
    <script
     src="https://code.jquery.com/jquery-3.7.1.min.js"
     integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
     crossorigin="anonymous"></script>
    <script src="http://ajax.microsoft.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script>
  
    <script>
       $(document).ready(function () {
             let uri = "https://sheets.googleapis.com/v4/spreadsheets/1-ajG5it_r4panQE7J9Sv6JSIA-gq-xG-FJJPSpcb74Y/values/%E9%9B%BB%E8%85%A6%E7%89%88?alt=json&key=AIzaSyA_hIi-8mQ2uZb7W_0Q_FY4hD2qk9gKUgA"
             $.get(uri, function( data ) {
                console.info('data',data)
                let location_list = data.values
                let htmlcode
    		    location_list.forEach(function(item) {
                      htmlcode += '<tr class="tr">
                                <td>item[0]</td>
                                <td>item[1]</td>
                                <td class="location">item[2]</td>
                                <td>item[8]</td>
                                <td>item[9]</td>
                                <td>item[10]</td>
                                <td>item[11]</td>
                                <td><i class="fa-regular fa-copy"></i></td>
                                <td class="checked"><i class="fa-solid fa-check"></i> 已複製</td>
                                </tr>'
                })
                 
                $("#rwd-pc").append(htmlcode)
                 
             })
            $(".fa-copy").click(function () {
                let location = $(this).parents('.tr').find('.location').text()
                console.info('info', location)
                copyToClipboard(location)
                $(this).parents('.tr').find('.checked').show().addClass('on')
                setTimeout(function(){
                    $(".checked.on").hide().removeClass('on')
                },3000)
            })
        })
        $(document).keydown(function (e) {
            let keyevent = event.which == 44 || event.key == 'PrintScreen'
            if(!!keyevent) {
                event.preventDefault()
            }
        })
        function copyToClipboard(item) {
            const clip = document.createElement('TEXTAREA')
            clip.value = item
            document.body.appendChild(clip)
            clip.select()
            document.execCommand('copy')
            document.body.removeChild(clip)
        }
    </script>
</body>
</html>
